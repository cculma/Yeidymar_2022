library(agricolae)
# Data analysis for Yeidymar
library(ggplot2)
library(tidyverse)
library(emmeans)
library(agricolae)
a1 <- read.csv("~/Documents/git/Yeidymar_2022/Alf_01.csv", header = T)
head(a1)
tail(a1)
colnames(a1)
colnames(a1)[1:4]
lev1 <- colnames(a1)[1:4]
lev1
a1[,lev1] <- lapply(a1[,lev1], factor)
str(a1)
levels(a1$GenotypeID)
summary(a1$GenotypeID)
View(a1)
head(a1)
a2 <- a1 %>% unite(col = "pop_gen", 1:2, sep = "_", remove = F)
View(a2)
str(a2)
a2$pop_gen <- as.factor(a2$pop_gen)
str(a2)
summary(a2$pop_gen)
cc <- count(a1, GenotypeID)
View(cc)
cc <- count(a2, pop_gen)
rm(a2)
a1 <- read.csv("~/Documents/git/Yeidymar_2022/Alf_01.csv", header = T)
head(a1)
tail(a1)
colnames(a1)
str(a1)
lev1 <- colnames(a1)[1:4]
a1[,lev1] <- lapply(a1[,lev1], factor)
str(a1)
head(a1)
a1 <- a1 %>% unite(col = "pop_gen", 1:2, sep = "_", remove = F)
head(a1)
str(a1)
a1$pop_gen <- as.factor(a1$pop_gen)
summary(a1$pop_gen)
cc <- count(a1, pop_gen)
View(cc)
colnames(a1)
head(a1)
a2 <- aggregate(log_CFU ~ pop_gen + LeafletID + DPI, data = a1, FUN = "mean")
colnames(a1)
a2 <- aggregate(LOG_CFU ~ pop_gen + LeafletID + DPI, data = a1, FUN = "mean")
View(a2)
head(a1)
a3 <- aggregate(Genome_copies ~  pop_gen + LeafletID + DPI, data = a1, FUN = "mean")
View(a3)
nrow(a3)
nrow(a2)
colnames(a2)
a4 <- full_join(a2, a3, by = c("pop_gen","LeafletID","DPI"))
str(a4)
summary(a4$pop_gen)
cc <- count(a4, pop_gen)
View(a4)
head(a4)
cor(a4$LOG_CFU, a4$Genome_copies, use = "complete.obs")
ggplot(a4, aes(x=LOG_CFU, y=Genome_copies)) + geom_point() + theme_ipsum(base_family = "Arial", base_size = 12)
library(hrbrthemes)
ggplot(a4, aes(x=LOG_CFU, y=Genome_copies)) + geom_point() + theme_ipsum(base_family = "Arial", base_size = 12)
ggplot(a4, aes(x = DPI, y = Genome_copies, fill = DPI)) + geom_boxplot()
ggplot(a4, aes(x = DPI, y = LOG_CFU, fill = DPI)) + geom_boxplot()
colnames(a4)
mod3 <- lm(LOG_CFU ~ DPI + pop_gen + DPI:pop_gen, data = a4)
anova(mod3)
mod4 <- aov(mod3)
mod4
# lsmeans(mod3, "plant_id_name")
tukey.test <- TukeyHSD(mod4)
tukey.test
mod1 <- lm(LOG_CFU ~ DPI, data = a4)
mod4 <- aov(mod1)
# lsmeans(mod3, "plant_id_name")
tukey.test <- TukeyHSD(mod4)
tukey.test
mod3 <- lm(LOG_CFU ~ DPI + pop_gen + DPI:pop_gen, data = a4)
mod4 <- aov(mod3)
# lsmeans(mod3, "plant_id_name")
tukey.test <- TukeyHSD(mod4)
View(tukey.test)
tukey.test[["DPI"]]
tukey.test[["pop_gen"]]
tukey.test[["pop_gen"]]
a5 <- a4 %>% dplyr::filter(DPI %in% "9")
View(a5)
mod1 <- lm(LOG_CFU ~ pop_gen, data = a5)
mod4 <- aov(mod1)
# lsmeans(mod3, "plant_id_name")
tukey.test <- TukeyHSD(mod4)
View(tukey.test)
tukey.test[["pop_gen"]]
p_sig <- as.data.frame(tukey.test[["pop_gen"]])
View(p_sig)
dim(p_sig)
head(p_sig)
colnames(p_sig)[4] <- "p_adj"
p_sig1 <- p_sig %>% dplyr::filter(p_adj < 0.05)
dim(p_sig1)
View(p_sig1)
p_9 <- p_sig1
a5 <- a4 %>% dplyr::filter(DPI %in% "0")
View(a5)
mod1 <- lm(LOG_CFU ~ pop_gen, data = a5)
anova(mod1)
mod4 <- aov(mod1)
# lsmeans(mod3, "plant_id_name")
tukey.test <- TukeyHSD(mod4)
tukey.test[["pop_gen"]]
p_sig <- as.data.frame(tukey.test[["pop_gen"]])
dim(p_sig)
colnames(p_sig)[4] <- "p_adj"
p_sig1 <- p_sig %>% dplyr::filter(p_adj < 0.05)
p_0 <- p_sig1
View(p_0)
View(p_9)
View(a5)
a5 <- a5 %>% dplyr::filter(!pop_gen %in% "5425_103")
mod1 <- lm(LOG_CFU ~ pop_gen, data = a5)
anova(mod1)
mod4 <- aov(mod1)
# lsmeans(mod3, "plant_id_name")
tukey.test <- TukeyHSD(mod4)
p_sig <- as.data.frame(tukey.test[["pop_gen"]])
dim(p_sig)
head(p_sig)
colnames(p_sig)[4] <- "p_adj"
p_sig1 <- p_sig %>% dplyr::filter(p_adj < 0.05)
p_0 <- p_sig1
View(p_0)
a5 <- a4 %>% dplyr::filter(DPI %in% "0")
View(a5)
a5 <- a4 %>% dplyr::filter(pop_gen %in% c("5425_150", "5425_103"))
View(a5)
head(a5)
ggplot(a5, aes(x = DPI, y = LOG_CFU, color = pop_gen)) + geom_line() + geom_point()
ggplot(a5, aes(x = DPI, y = LOG_CFU, group = pop_gen)) + geom_line() + geom_point()
ggplot(a5, aes(x = DPI, y = LOG_CFU, group = pop_gen)) + geom_line(color = pop_gen) + geom_point(color = pop_gen)
ggplot(a5, aes(x = DPI, y = LOG_CFU, group = pop_gen)) + geom_line(aes(color = pop_gen)) + geom_point(aes(color = pop_gen))
a1 <- read.csv("~/Documents/git/Yeidymar_2022/Alf_03.csv", header = T)
View(a1)
library(ggplot2)
library(tidyverse)
library(emmeans)
library(agricolae)
library(hrbrthemes)
?lm
?aov
